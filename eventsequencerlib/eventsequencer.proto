syntax = "proto3";

package pb;

message Strip {
  int32 channel = 1;
  int32 startFrame = 2;
  int32 length = 3;

  BadJs badJs = 10;
  BadAudio badAudio = 11;
  Text text = 12;
  Label label = 13;

  message BadJs {
    string script = 1;
  }
  message BadAudio {
    string fileName = 1;
  }
  message Text {
    string content = 1;
  }
  message Label {
    string content = 1;
  }
}

message ChannelData {
  message BadClock { }
  message BadJs { }
  message Text {
    reserved 1;
    string content = 2;
  }
  message BadAudio {}
  message Label {}
  message Collate {
    int32 channelFrom = 10;
    int32 channelTo = 11;
  }

  oneof channel {
    BadClock badClock = 10;
    BadJs badJs = 11;
    Text text = 12;
    BadAudio badAudio = 13;
    Label label = 14;
    Collate collate = 15;
  };
}

message Document {
  // TODO Should probably have a version number.
  repeated Strip strips = 1;
  int32 framesPerSecond = 2;
  int32 startFrame = 4;
  int32 endFrame = 5;
  map<int32, ChannelData> channels = 3;
}

message File {
  Document document = 1;
  string checksum = 2;
  string forkedFromChecksum = 3;
}

message ManagedResource {
  string suffix = 1;
}
